В DAG реализован следующий ETL-процесс:

1. **Extract.**

   Необходимые данные хранятся в таблице profit_table.csv. Это таблица, в которой для каждого клиента по 10-ти продуктам собраны суммы и количества транзакций за каждый месяц.

   Что в названиях столбцов:

   id —  уникальный идентификатор клиента;
   продукты обозначены буквами от a до j латинского алфавита;
   сумма транзакций по соответствующим продуктам начинается с sum_…;
   количество транзакций по соответствующим продуктам начинается с count_….
   Для примера в таблице содержатся данные с октября 2023 года по март 2024.

2. **Transform.**

   Суть собираемой витрины - таблица с флагами активностей клиентов по продуктам. Методика расчёта следующая: клиент считается активным по продукту за дату X, если в предыдущие 3 месяца (X, X-1 и X-2) у него были ненулевая сумма и количество транзакций по нему.


3. **Load.**

   Итоговые результаты сохраняются в csv-файл flags_activity.csv в директории data, не перезатирая при этом данные старых расчётов в нём.

Особенности дага: он должен запускаться по расписанию каждый месяц 5-го числа. Предполагается, что данные profit_table хранятся в общедоступной директории и пополняются ежемесячно новыми данными - поэтому при чтении таблицы всё должно выполниться без ошибок при наличии данных.

<img width="1881" height="509" alt="Screen-368" src="https://github.com/user-attachments/assets/409354c3-439d-4b3d-856a-1543ef867519" />
